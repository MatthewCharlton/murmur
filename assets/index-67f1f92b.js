import{c as b,a as o,i as l,S as f,t as h,u as g,s as c,D as u}from"./index-cabe918c.js";import m from"./index-c8c820a2.js";import"./browser-ponyfill-5ce9a37a.js";const _=h('<div class="fixed bottom-5 mx-5 right-0 z-10 bg-white border-2 p-4 max-w-md min-h-10">Install the murmur web app to your device<br><br> </div>'),I="BJfNA6Vn9RS-6mQq5mnS7nZrMMzUQUcG9_fkMab_dj3dmxrzCewj-WRSijzs0kbYQVteJbS-9dMcDn-4wAfm4Dk",d="murmur-pwa-install-decline",D=3*60*60*1e3,v=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(async r=>{const n=g().username;r.pushManager.getSubscription().then(async t=>{if(t)return;const{data:a,error:i}=await c.from(u).select();if(i||!a||a.length>0)return;const e=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:I});await c.from(u).insert([{subscription:JSON.stringify(e),email:n()}])})})},y=()=>{v();const[r,n]=b(!1);let t;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault();const s=Number(window?.localStorage?.getItem(d));s&&s+D>Date.now()||(t=e,setTimeout(()=>n(!0),1e3))});const a=async()=>{n(!1),t.prompt(),await t.userChoice,t=null},i=()=>{window?.localStorage?.setItem(d,Date.now().toString()),n(!1)};return o(f,{get when(){return r()},get children(){const e=_.cloneNode(!0),s=e.firstChild,p=s.nextSibling,w=p.nextSibling,S=w.nextSibling;return l(e,o(m,{onClick:a,children:"Install murmur"}),S),l(e,o(m,{onClick:i,children:"Not now"}),null),e}})};export{y as default};
